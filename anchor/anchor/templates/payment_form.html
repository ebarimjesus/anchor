{% load static %}
<!DOCTYPE html>
<html>
<head>
    <title>AFRO Token ICO</title>
    <!-- Include Paystack's JavaScript library -->
    <script src="https://js.paystack.co/v1/inline.js"></script>
</head>
<body>
    <h1>AFRO Token Initial Coin Offering (ICO)</h1>
    <p>Welcome to the AFRO Token ICO! Get your AFRO tokens now.</p>

    <div id="token-price">
        <p>1 AFRO Token = $<span id="afro-to-usdc">0.50</span> USD</p>
    </div>

    <div id="token-amount">
        <label for="amount">Enter the number of AFRO tokens you want to purchase:</label>
        <input type="number" id="amount" min="1" step="1" placeholder="Enter the amount">
        <button id="calculate-button">Calculate Total</button>
    </div>

    <div id="total-cost">
        <p>Total Cost: $<span id="total-amount">0.50</span> USD</p>
        <p>Total Cost in NGN: â‚¦<span id="total-amount-ngn">0.00</span> NGN</p>
    </div>

    <div>
        <label for="email-address">Enter your email address:</label>
        <input type="email" id="email-address" placeholder="Your email address">
    </div>

    <div id="user-info">
        <label for="user-address">Enter your Stellar public key or federation address:</label>
        <input type="text" id="user-address" placeholder="Stellar public key or federation address">
    </div>

    <div id="payment-options">
        <p>Select your payment method:</p>
        <!-- Use Paystack's payment form -->
        <button id="paystack-button">Pay with Paystack</button>
    </div>

    <div id="transaction-status">
        <!-- Transaction status will be displayed here -->
    </div>

    <script>
        // Function to calculate the total cost based on the number of tokens entered
        function calculateTotal() {
            const amount = parseFloat(document.getElementById("amount").value);
            const afroToUsd = parseFloat(document.getElementById("afro-to-usdc").textContent);
            const totalAmount = amount * afroToUsd;
            document.getElementById("total-amount").textContent = totalAmount.toFixed(2);

            // Calculate the total cost in NGN based on the calculated total amount in USD
            const ngnRate = 500; // Replace with your NGN to USD exchange rate
            const totalAmountNGN = totalAmount * ngnRate;
            document.getElementById("total-amount-ngn").textContent = totalAmountNGN.toFixed(2);
        }

        // Add an event listener to the "Calculate Total" button
        document.getElementById("calculate-button").addEventListener("click", calculateTotal);

        // Function to initialize the Paystack payment
        function initializePayment() {
            const amountNGN = parseFloat(document.getElementById("total-amount-ngn").textContent) * 100; // Convert to kobo (Paystack's currency unit)
            const email = document.getElementById('email-address').value;
            const publicKey = "pk_live_081c6cf541c64f08115d6285e4b0b5d69953e651"; // Replace with your Paystack public key
            const reference = "AFROICO_" + Date.now(); // Generate a unique reference

            // Create the Paystack handler
            var handler = PaystackPop.setup({
                key: publicKey,
                email: email,
                amount: amountNGN,
                currency: "NGN", // Use the appropriate currency code
                ref: reference,
                callback: function (response) {
                    // Handle successful payment here
                    document.getElementById("transaction-status").innerHTML = "<p>Payment successful! You will receive your AFRO tokens shortly.</p>";
                },
                onClose: function () {
                    // Handle payment cancellation or failure
                    document.getElementById("transaction-status").innerHTML = "<p>Payment canceled or failed. Please try again.</p>";
                }
            });

            // Open the Paystack payment modal
            handler.openIframe();
        }

        // Add an event listener to the "Pay with Paystack" button
        document.getElementById("paystack-button").addEventListener("click", initializePayment);
    </script>
</body>
</html>


